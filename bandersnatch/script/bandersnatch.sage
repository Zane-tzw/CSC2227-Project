
p=52435875175126190479447740508185965837690552500527637822603658699938581184513
Fp=Zmod(p)


#####################################################
# Twised Edwards curve: a * x² + y² = 1 + d * x² * y²
#####################################################
TEa=Fp(52435875175126190479447740508185965837690552500527637822603658699938581184508)
TEd=Fp(45022363124591815672509500913686876175488063829319466900776701791074614335719)

# TE curve generator
TEx = Fp(18886178867200960497001835917649091219057080094937609519140440539760939937304)
TEy = Fp(19188667384257783945677642223292697773471335439753913231509108946878080696678)

assert(TEa * TEx^2 + TEy^2 - 1 - TEd * TEx^2 * TEy^2 == 0)

#####################################################
# Montgomery curve: By² = x³ + A * x² + x
#####################################################
MB=Fp(25465760566081946422412445027709227188579564747101592991722834452325077642517)
MA=Fp(29978822694968839326280996386011761570173833766074948509196803838190355340952)

assert((TEa +TEd)*2/(TEa-TEd) == MA)
assert(4/(TEa-TEd) == MB )

# M curve generator
Mx = (1+TEy)/(1-TEy)
My = Mx/TEx


assert(MB * My^2 - Mx^3 - MA * Mx^2 - Mx == 0)

#####################################################
# Weierstrass curve: y² = x³ + A * x + B
#####################################################
WA=Fp(10773120815616481058602537765553212789256758185246796157495669123169359657269)
WB=Fp(29569587568322301171008055308580903175558631321415017492731745847794083609535)

assert((3-MA^2)/3/MB^2 == WA)
assert((2*MA^3-9*MA)/27/MB^3 == WB)

Wx = Mx/MB + MA/3/MB
Wy = My/MB

assert(Wy^2 - Wx^3 - WA * Wx - WB == 0)


# finding the lambda parameter
r = 13108968793781547619861935127046491459309155893440570251786403306729687672801
r1 = 4257185345094557079734489188109952172285839137338142340240392707284963971010
k11 = 30417741863887432744214758610616508258
k12 = -6406990765953933188067911864924578940
r2 = 0x1CC9532465758E825E7BCE24A0CC661A28AD31385D1E5CC0FFB1301F9455D6DD
k21 = 0x453B6AB909ED3FD4699D8E32BAA2CD52
k22 = 0x1CFB69D4CA675F520CCE760202687600E17908498D0235916A5C8548BD0EEED1 - r